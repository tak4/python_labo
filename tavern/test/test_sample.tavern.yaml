test_name: 簡単なテスト

includes:
  - !include ../include/includes.yaml

stages:
  - name: 200が返ってくるかどうかのテスト
    request:
      url: http://127.0.0.1:5000/items
      method: GET
    response:
      status_code: 200

  - name: jsonのテスト
    request:
      url: http://127.0.0.1:5000/items
      method: GET
    response:
      status_code: 200
      json:
        user_info:
          user_id: "{user_id:s}"
          user_name: "{user_name:s}"

  - name: jsonのテスト(外部関数)
    request:
      url: http://127.0.0.1:5000/items
      method: GET
    response:
      status_code: 200
      verify_response_with:
        function: helper.testing_utils:is_specified_json
        extra_kwargs:
          schema: 
            user_id: "{user_id:s}"
            user_name: "{user_name:s}"

  - name: responseの保存
    request:
      url: http://127.0.0.1:5000/items
      method: GET
    response:
      status_code: 200
      verify_response_with:
        function: helper.testing_utils:save_response
        extra_kwargs:
          fname: response.txt

  - name: request変数
    request:
      url: http://127.0.0.1:5000/requestval?name="testuser"&age=20
      method: GET
    response:
      status_code: 200
      verify_response_with:
        function: helper.testing_utils:save_response
        extra_kwargs:
          fname: requestval.txt
